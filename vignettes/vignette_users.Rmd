---
title: "Redcap User Management"
author: "Kenneth McLean"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

Management of user rights in REDCap becomes increasingly laborious as the scale of the research project expands (e.g. with the number of users, and the number of data access groups). However, at present, REDCap does not inherently support mass-upload directly to the user rights module of a project. 

## Exploration of current users
1. Use `user_roles_n()` to count the number of unique user "roles" within the REDcap Project. There are 3 outputs:
 - A string stating "There are n unique roles in this redcap project".
 - A nested dataframe of
  - $full: A dataframe of all user rights of the redcap project (with an additional column called "role" which numbers users 1:n according to their unique role).
  - $examples: A dataframe of each role (1:n) and an example username with those rights (can be used as input for the `user_roles()` function).

2. 



```{r, warning=FALSE, message=FALSE}
data(output_user_roles_n)
```

im_role$examples

im_role_examples <- im_role$example %>%
   dplyr::mutate(role = factor(role,
                       levels=c(1:nrow(im_role$example)),
                       labels=c("admin", "committee", "collaborator", "validator", NA))) %>%
  dplyr::mutate(role = as.character(role))


im_role_users <- user_roles(redcap_project_uri = url_bmhredcap,
                            redcap_project_token = token_projectdata,
                            role_users_example = im_role_examples)
table(im_role_users$role)


## Exploration of current users
